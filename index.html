<!DOCTYPE html>
<html lang="ja">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Freeze - 画像フレーム作成</title>
	<style>
		body {
			margin: 0;
			font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', system-ui, sans-serif;
			background: #111;
			color: #fff;
			overflow-x: hidden;
		}
		.header {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 16px 24px;
			background: #000;
			border-bottom: 1px solid #333;
		}
		.header span:first-child {
			font-size: 1.25em;
			font-weight: bold;
		}
		.version {
			font-size: 0.875em;
			color: #999;
		}
		.main {
			display: flex;
			height: calc(100vh - 60px);
		}
		.logo {
			flex: 1;
			display: flex;
			align-items: center;
			justify-content: center;
			background: #1a1a1a;
		}
		.panel {
			width: 300px;
			background: #222;
			border-left: 1px solid #333;
			overflow-y: auto;
		}
		.actions-label, .settings-label {
			display: flex;
			align-items: center;
			gap: 8px;
			padding: 16px 24px 8px;
			font-size: 0.875em;
			color: #aaa;
			text-transform: uppercase;
			font-weight: 600;
		}
		.btn {
			background: #444;
			border: none;
			color: #fff;
			padding: 8px 16px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 0.875em;
			width: 100%;
			margin-bottom: 8px;
		}
		.btn:hover {
			background: #555;
		}
		.section-content {
			padding: 16px 0;
		}
		.section-content label {
			display: block;
			font-size: 0.875em;
			margin-bottom: 8px;
			color: #ccc;
		}
		.color-bar {
			display: flex;
			align-items: center;
			gap: 8px;
			margin-bottom: 16px;
		}
		.color-bar .bar {
			flex: 1;
			height: 24px;
			border-radius: 4px;
			border: 1px solid #333;
		}
		.color-bar .edit-btn {
			background: #444;
			border: none;
			color: #fff;
			padding: 4px 8px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 0.75em;
		}
		.color-bar .edit-btn:hover {
			background: #555;
		}
		.switch-label {
			display: flex;
			align-items: center;
			gap: 8px;
			font-size: 1em;
			color: #fff;
		}
		.switch {
			width: 40px;
			height: 22px;
			appearance: none;
			background: #333;
			outline: none;
			border-radius: 22px;
			position: relative;
			transition: background 0.2s;
		}
		.switch:checked {
			background: #90caf9;
		}
		.switch::after {
			content: '';
			position: absolute;
			left: 2px;
			top: 2px;
			width: 18px;
			height: 18px;
			background: #fff;
			border-radius: 50%;
			transition: left 0.2s;
		}
		.switch:checked::after {
			left: 20px;
		}
		.panel .actions {
			display: flex;
			gap: 16px;
			padding: 0 24px;
			margin-bottom: 8px;
		}
		.panel .actions i {
			font-size: 1.5em;
			cursor: pointer;
			color: #90caf9;
		}
		.panel .actions i:hover {
			color: #fff;
		}
		.panel .settings {
			padding: 0 24px;
		}
		.panel .settings .section {
			background: #1a1a1a;
			border: none;
			color: #fff;
			margin-bottom: 8px;
			border-radius: 4px;
		}
		.panel .settings .section summary {
			font-weight: bold;
			cursor: pointer;
			padding: 12px 16px;
			list-style: none;
		}
		.panel .settings .section summary::-webkit-details-marker {
			display: none;
		}
		.panel .settings .section summary::before {
			content: '▶';
			display: inline-block;
			margin-right: 8px;
			transition: transform 0.2s;
		}
		.panel .settings .section[open] summary::before {
			transform: rotate(90deg);
		}
		.panel .settings .section[open] {
			background: #333;
		}
		.panel .settings .section[open] .section-content {
			padding: 0 16px 16px;
		}

		/* 切り取りモーダル */
		.crop-modal {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.9);
			display: none;
			align-items: center;
			justify-content: center;
			z-index: 1000;
		}
		.crop-container {
			position: relative;
			background: #333;
			padding: 20px;
			border-radius: 8px;
			max-width: 90vw;
			max-height: 90vh;
		}
		.crop-title {
			color: #fff;
			font-size: 18px;
			margin-bottom: 20px;
			text-align: center;
		}
		.crop-area {
			position: relative;
			display: inline-block;
			margin-bottom: 20px;
			cursor: grab;
		}
		.crop-area.dragging {
			cursor: grabbing;
		}
		.crop-canvas {
			display: block;
			max-width: 70vw;
			max-height: 60vh;
		}
		.crop-overlay {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			pointer-events: none;
		}
		.crop-buttons {
			display: flex;
			gap: 10px;
			justify-content: center;
		}
		.crop-btn {
			background: #007bff;
			color: white;
			border: none;
			padding: 10px 20px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
		}
		.crop-btn:hover {
			background: #0056b3;
		}
		.crop-btn.cancel {
			background: #6c757d;
		}
		.crop-btn.cancel:hover {
			background: #545b62;
		}
		.crop-handle {
			position: absolute;
			width: 12px;
			height: 12px;
			background: #00ff00;
			border: 2px solid #fff;
			border-radius: 50%;
			cursor: pointer;
			pointer-events: auto;
			transform: translate(-50%, -50%);
		}
		.crop-handle:hover {
			background: #00dd00;
			transform: translate(-50%, -50%) scale(1.2);
		}
		.frame-container {
			position: relative;
			width: 512px;
			height: 512px;
			margin: 40px auto;
			background: transparent;
		}
		.outer-circle {
			position: absolute;
			left: 0; top: 0;
			width: 100%; height: 100%;
			border-radius: 50%;
			border: 8px solid #333;
			box-sizing: border-box;
		}
		.inner-circle {
			position: absolute;
			left: 50%; top: 50%;
			width: 320px; height: 320px;
			transform: translate(-50%, -50%);
			border-radius: 50%;
			background: white;
			z-index: 2;
		}
		.ring-image {
			position: absolute;
			left: 1px;
			top: 78px;
			width: 510px;
			height: 408px;
			object-fit: contain;
			z-index: 1;
			pointer-events: none;
		}

		/* 色編集モーダル */
		.color-edit-modal {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.8);
			display: none;
			align-items: center;
			justify-content: center;
			z-index: 1000;
		}
		.color-edit-container {
			background: #333;
			padding: 24px;
			border-radius: 8px;
			width: 400px;
			max-width: 90vw;
		}
		.color-edit-title {
			color: #fff;
			font-size: 18px;
			margin-bottom: 20px;
			text-align: center;
		}
		.color-gradient-section {
			margin-bottom: 20px;
			max-height: 300px;
			overflow-y: auto;
		}
		.color-gradient-item {
			display: flex;
			align-items: center;
			gap: 8px;
			margin-bottom: 12px;
			padding: 8px;
			background: #444;
			border-radius: 4px;
			transition: box-shadow 0.2s, transform 0.2s;
		}
		.color-gradient-item.dragging {
			opacity: 0.7;
			box-shadow: 0 4px 16px rgba(0,0,0,0.2);
			z-index: 10;
		}
		.color-gradient-item.drag-over {
			transform: translateY(12px);
			box-shadow: 0 2px 8px rgba(0,0,0,0.15);
		}
		.color-drag-handle {
			cursor: grab;
			color: #999;
			padding: 4px;
		}
		.color-item-preview {
			width: 40px;
			height: 24px;
			border-radius: 4px;
			border: 1px solid #666;
		}
		.color-item-input {
			width: 32px;
			height: 24px;
			border: none;
			border-radius: 4px;
			cursor: pointer;
		}
		.color-angle-input {
			background: #555;
			border: none;
			color: #fff;
			padding: 4px 8px;
			border-radius: 4px;
			width: 60px;
		}
		.color-delete-btn {
			background: #dc3545;
			border: none;
			color: #fff;
			padding: 4px 8px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 0.75em;
		}
		.color-delete-btn:hover {
			background: #c82333;
		}
		.color-add-btn {
			background: #28a745;
			border: none;
			color: #fff;
			padding: 8px 16px;
			border-radius: 4px;
			cursor: pointer;
			width: 100%;
			margin-bottom: 16px;
		}
		.color-add-btn:hover {
			background: #218838;
		}
		.color-toggle-section {
			margin-bottom: 20px;
		}
		.color-modal-buttons {
			display: flex;
			gap: 10px;
			justify-content: center;
		}
		.color-modal-btn {
			background: #007bff;
			color: white;
			border: none;
			padding: 10px 20px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
		}
		.color-modal-btn:hover {
			background: #0056b3;
		}
		.color-modal-btn.close {
			background: #6c757d;
		}
		.color-modal-btn.close:hover {
			background: #545b62;
		}

		/* プリセット保存モーダル */
		.preset-save-modal {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.8);
			display: none;
			align-items: center;
			justify-content: center;
			z-index: 1000;
		}
		.preset-save-container {
			background: #333;
			padding: 24px;
			border-radius: 8px;
			width: 400px;
			max-width: 90vw;
		}
		.preset-save-title {
			color: #fff;
			font-size: 18px;
			margin-bottom: 20px;
			text-align: center;
		}
		.preset-name-input {
			width: 100%;
			background: #444;
			border: none;
			color: #fff;
			padding: 10px;
			border-radius: 4px;
			margin-bottom: 20px;
			font-size: 14px;
		}
		.preset-save-buttons {
			display: flex;
			gap: 10px;
			justify-content: center;
		}
		.preset-save-btn {
			background: #28a745;
			color: white;
			border: none;
			padding: 10px 20px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
		}
		.preset-save-btn:hover {
			background: #218838;
		}
		.preset-cancel-btn {
			background: #6c757d;
			color: white;
			border: none;
			padding: 10px 20px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
		}
		.preset-cancel-btn:hover {
			background: #545b62;
		}

		/* プリセット読み込みモーダル */
		.preset-load-modal {
			position: fixed;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background: rgba(0, 0, 0, 0.8);
			display: none;
			align-items: center;
			justify-content: center;
			z-index: 1000;
		}
		.preset-load-container {
			background: #333;
			padding: 24px;
			border-radius: 8px;
			width: 500px;
			max-width: 90vw;
			max-height: 80vh;
			overflow-y: auto;
		}
		.preset-load-title {
			color: #fff;
			font-size: 18px;
			margin-bottom: 20px;
			text-align: center;
		}
		.preset-item {
			display: flex;
			align-items: center;
			justify-content: space-between;
			background: #444;
			padding: 12px;
			margin-bottom: 8px;
			border-radius: 4px;
		}
		.preset-name {
			color: #fff;
			font-size: 14px;
		}
		.preset-date {
			color: #999;
			font-size: 12px;
		}
		.preset-actions {
			display: flex;
			gap: 8px;
		}
		.preset-load-btn {
			background: #007bff;
			color: white;
			border: none;
			padding: 6px 12px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 12px;
		}
		.preset-load-btn:hover {
			background: #0056b3;
		}
		.preset-delete-btn {
			background: #dc3545;
			color: white;
			border: none;
			padding: 6px 12px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 12px;
		}
		.preset-delete-btn:hover {
			background: #c82333;
		}
		.preset-close-btn {
			background: #6c757d;
			color: white;
			border: none;
			padding: 10px 20px;
			border-radius: 4px;
			cursor: pointer;
			font-size: 14px;
			width: 100%;
			margin-top: 16px;
		}
		.preset-close-btn:hover {
			background: #545b62;
		}
		.no-presets {
			text-align: center;
			color: #999;
			font-style: italic;
			padding: 20px;
		}
	</style>
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
	<div class="header">
		<span>Freeze</span>
		<span class="version">created by つっくん</span>
	</div>
	<div class="main">
		<div class="logo">
			<canvas id="frameCanvas" width="512" height="512" style="background:transparent;"></canvas>
		</div>
		<div class="panel">
			<div class="actions-label">
				<i class="fa-solid fa-hand-pointer"></i>
				<span>操作</span>
			</div>
			<div class="actions">
                <i class="fa-solid fa-bookmark" title="プリセットを保存" id="savePresetBtn"></i>
                <i class="fa-solid fa-folder-open" title="プリセットを読み込む" id="loadPresetBtn"></i>
                <i class="fa-solid fa-save" title="保存" id="saveBtn"></i>
                <i class="fa-solid fa-code" title="構成をJSONで表示" id="showConfigJsonBtn"></i>
			</div>
			<div class="settings-label">
				<i class="fa-solid fa-gear"></i>
				<span>設定</span>
			</div>
			<div class="settings">
				<details class="section">
					<summary>画像</summary>
					<div class="section-content">
						<button class="btn" id="imageBtn">画像を読み込む</button>
						<input type="file" id="imgInput" accept="image/*" style="display:none;">
					</div>
				</details>
				<details class="section">
					<summary>色</summary>
					<div class="section-content">
						<label>背景の色</label>
						<div class="color-bar">
							<div class="bar" style="background: linear-gradient(to right, #a00000, #200000);"></div>
							<button class="edit-btn" onclick="openColorEditModal('bg')">編集</button>
						</div>
						<label>枠線の色</label>
						<div class="color-bar">
							<div class="bar" style="background: #fff;"></div>
							<button class="edit-btn" onclick="openColorEditModal('frame')">編集</button>
						</div>
						<label>文字の色</label>
						<div class="color-bar">
							<div class="bar" style="background: #fff;"></div>
							<button class="edit-btn" onclick="openColorEditModal('text')">編集</button>
						</div>
					</div>
				</details>
				<details class="section">
					<summary>背景</summary>
					<div class="section-content">
						<label class="switch-label">
						<input type="checkbox" class="switch" id="bgSwitch">
						中央円の背景を描画する
						</label>
					</div>
				</details>
				<details class="section">
					   <summary>テキスト</summary>
					   <div class="section-content" id="textSection">
						   <button class="btn" id="addTextBtn">+ テキスト追加</button>
						   <div id="textList"></div>
					   </div>
				</details>
			</div>
		</div>
	</div>

	<!-- 切り取りモーダル -->
	<div class="crop-modal" id="cropModal">
		<div class="crop-container">
			<div class="crop-title">切り取り</div>
			<div class="crop-area" id="cropArea">
				<canvas id="cropCanvas" class="crop-canvas"></canvas>
				<canvas id="cropOverlay" class="crop-overlay"></canvas>
			</div>
			<div class="crop-buttons">
				<button class="crop-btn cancel" id="cropCancel">キャンセル</button>
				<button class="crop-btn" id="cropConfirm">切り取り</button>
			</div>
		</div>
	</div>

	<!-- 色編集モーダル -->
	<div class="color-edit-modal" id="colorEditModal">
		<div class="color-edit-container">
			<div class="color-edit-title" id="colorEditTitle">色の編集</div>
			<div class="color-gradient-section">
				<div id="colorGradientList"></div>
			</div>
			<button class="color-add-btn" id="addColorBtn" style="margin-bottom: 16px;">+ 色を追加</button>
			<div class="color-toggle-section">
				<label class="switch-label">
					<input type="checkbox" class="switch" id="alphaWindowToggle">
					半透明ウィンドウ
				</label>
			</div>
			<div class="color-modal-buttons">
				<button class="color-modal-btn close" id="closeColorEdit">閉じる</button>
			</div>
		</div>
	</div>

	<!-- プリセット保存モーダル -->
	<div class="preset-save-modal" id="presetSaveModal">
		<div class="preset-save-container">
			<div class="preset-save-title">プリセットを保存</div>
			<input type="text" class="preset-name-input" id="presetNameInput" placeholder="プリセット名を入力してください" maxlength="50">
			<div class="preset-save-buttons">
				<button class="preset-cancel-btn" id="presetSaveCancel">キャンセル</button>
				<button class="preset-save-btn" id="presetSaveConfirm">保存</button>
			</div>
		</div>
	</div>

	<!-- プリセット読み込みモーダル -->
	<div class="preset-load-modal" id="presetLoadModal">
		<div class="preset-load-container">
			<div class="preset-load-title">プリセットを読み込む</div>
			<div id="presetList"></div>
			<button class="preset-close-btn" id="presetLoadClose">閉じる</button>
		</div>
	</div>

    <!-- 構成JSON表示モーダル -->
    <div class="preset-load-modal" id="configJsonModal" style="display:none;">
        <div class="preset-load-container" style="max-width:700px;">
            <div class="preset-load-title">現在の構成（JSON）</div>
            <pre id="configJsonText" style="background:#222;color:#fff;padding:16px;border-radius:6px;max-height:350px;overflow:auto;font-size:13px;"></pre>
            <button class="preset-close-btn" id="configJsonClose">閉じる</button>
        </div>
    </div>

	   <script src="script.js"></script>
</body>
</html>